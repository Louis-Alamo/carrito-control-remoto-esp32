<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Control ESP32</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            /* Evita selecci√≥n de texto al tocar botones */
            user-select: none;
            -webkit-user-select: none;
        }

        h1 {
            margin-bottom: 20px;
        }

        /* La cuadr√≠cula para los botones */
        .control-pad {
            display: grid;
            grid-template-columns: 100px 100px 100px;
            grid-template-rows: 100px 100px 100px;
            gap: 10px;
        }

        /* Estilo base de los botones */
        .btn {
            width: 100%;
            height: 100%;
            background-color: #444;
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            /* Para que funcionen r√°pido en m√≥viles */
            touch-action: manipulation;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Efecto al presionar */
        .btn:active,
        .btn.active {
            background-color: #00d2ff;
            color: #000;
            transform: scale(0.95);
        }

        /* Posicionamiento en la cuadr√≠cula */
        #btnAdelante {
            grid-column: 2;
            grid-row: 1;
        }

        #btnIzquierda {
            grid-column: 1;
            grid-row: 2;
        }

        #btnDerecha {
            grid-column: 3;
            grid-row: 2;
        }

        #btnAtras {
            grid-column: 2;
            grid-row: 3;
        }

        #btnStop {
            grid-column: 2;
            grid-row: 2;
            background-color: #a00;
        }
    </style>
</head>

<body>

    <h1>Control Remoto</h1>

    <div class="control-pad">
        <button id="btnAdelante" class="btn">‚ñ≤</button>
        <button id="btnIzquierda" class="btn">‚óÑ</button>
        <button id="btnStop" class="btn">üõë</button>
        <button id="btnDerecha" class="btn">‚ñ∫</button>
        <button id="btnAtras" class="btn">‚ñº</button>
    </div>

    <p style="margin-top:20px; color:#888;">Mant√©n presionado para mover</p>

    <script>
        // --- L√≥gica de Control ---

        function enviarComando(accion) {
            console.log("Enviando: " + accion);
            fetch('/' + accion).catch(err => console.error(err));
        }

        // Asigna eventos a un bot√≥n (para PC y M√≥vil)
        function configurarBoton(id, comando) {
            const btn = document.getElementById(id);

            // Eventos para Mouse (PC)
            btn.addEventListener('mousedown', () => enviarComando(comando));
            btn.addEventListener('mouseup', () => enviarComando('detener'));
            btn.addEventListener('mouseleave', () => enviarComando('detener')); // Si sacas el mouse del bot√≥n

            // Eventos T√°ctiles (M√≥vil) - ¬°Cruciales!
            btn.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Evita scroll o zoom
                enviarComando(comando);
                btn.classList.add('active'); // Efecto visual manual
            });

            btn.addEventListener('touchend', (e) => {
                e.preventDefault();
                enviarComando('detener');
                btn.classList.remove('active');
            });
        }

        // Configuramos los 4 botones
        configurarBoton('btnAdelante', 'adelante');
        configurarBoton('btnAtras', 'atras');
        configurarBoton('btnIzquierda', 'izquierda');
        configurarBoton('btnDerecha', 'derecha');

        // El bot√≥n central de STOP es un "kill switch" manual
        document.getElementById('btnStop').addEventListener('click', () => enviarComando('detener'));

    </script>
</body>

</html>